<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OneDrop Marketplace</title>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    crossorigin="anonymous"
  />
  <style>
    :root {
      --main: #00ffcc;
      --main-dark: #00d6b3;
      --dark: #0f0f0f;
      --darker: #0a0a0a;
      --bg: #1a1a1a;
      --bg-light: #222;
      --radius: 16px;
      --radius-sm: 10px;
      --text: #f1f1f1;
      --text-secondary: #a0a0a0;
      --success: #00cc88;
      --warning: #ffaa44;
      --danger: #ff6b6b;
      --shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
      --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      --category-electronics: #ff6b6b;
      --category-clothing: #4dabf7;
      --category-bike: #40c057;
      --category-other: #cc5de8;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: var(--darker);
      background-image: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #0f0f0f 100%);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding-bottom: 100px;
      overflow-x: hidden;
      line-height: 1.6;
    }

    header {
      padding: 1.2rem 1rem;
      background: var(--dark);
      width: 100%;
      text-align: center;
      font-size: clamp(1.1rem, 4vw, 1.6rem);
      font-weight: 800;
      letter-spacing: 0.5px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.8rem;
      flex-wrap: wrap;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      background: rgba(15, 15, 15, 0.85);
    }

    .logo {
      width: 36px;
      height: 36px;
      border: 3px solid var(--main);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      animation: pulse 3s infinite ease-in-out;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(0.95); opacity: 0.8; box-shadow: 0 0 0 0 rgba(0, 255, 204, 0.4); }
      50% { transform: scale(1.05); opacity: 1; box-shadow: 0 0 0 10px rgba(0, 255, 204, 0); }
    }

    .logo i {
      font-size: 1.2rem;
      color: var(--main);
    }

    .categories {
      display: flex;
      gap: 0.8rem;
      padding: 1rem;
      width: 100%;
      max-width: 1400px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .category-btn {
      padding: 0.7rem 1.5rem;
      border-radius: 50px;
      background: var(--bg);
      border: none;
      color: var(--text);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .category-btn.active {
      background: var(--main);
      color: #000;
    }

    .category-btn i {
      font-size: 1.1rem;
    }

    .products {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      justify-content: center;
      margin-top: 0.5rem;
      width: 100%;
      max-width: 1400px;
      padding: 1rem;
      gap: 2rem;
    }

    .product-card {
      background: var(--bg);
      border-radius: var(--radius);
      padding: 1.8rem;
      box-shadow: var(--shadow);
      animation: fadeIn 0.6s ease forwards;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      height: 100%;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      cursor: pointer;
    }

    .product-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 40px rgba(0, 255, 204, 0.2);
      border-color: rgba(0, 255, 204, 0.2);
    }

    .product-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--main);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.6s ease;
    }

    .product-card:hover::before {
      transform: scaleX(1);
    }

    .product-images {
      position: relative;
      width: 100%;
      border-radius: var(--radius-sm);
      margin-bottom: 1.5rem;
      overflow: hidden;
      aspect-ratio: 16/9;
      background: #151515;
    }

    .main-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }

    .thumbnails {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.8rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .thumbnail {
      width: 60px;
      height: 40px;
      border-radius: 6px;
      object-fit: cover;
      cursor: pointer;
      opacity: 0.7;
      transition: var(--transition);
      border: 2px solid transparent;
    }

    .thumbnail:hover, .thumbnail.active {
      opacity: 1;
      border-color: var(--main);
    }

    .product-title {
      font-size: 1.4rem;
      margin-bottom: 1.2rem;
      text-align: center;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .product-title i {
      color: var(--main);
      font-size: 1.2rem;
    }

    .price-container, .timer-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.8rem;
      margin: 0.8rem 0;
      width: 100%;
    }

    .price-container i, .timer-container i {
      font-size: 1.4rem;
      color: var(--main);
      width: 30px;
      text-align: center;
    }

    .price, .timer {
      font-size: 1.4rem;
      height: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      font-weight: 700;
      background: rgba(0, 0, 0, 0.3);
      padding: 0.5rem 1rem;
      border-radius: var(--radius-sm);
      min-width: 140px;
    }

    .price .value, .timer .value {
      color: var(--main);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      min-width: 80px;
    }

    .digit {
      display: inline-block;
      height: 100%;
      position: relative;
      vertical-align: top;
      width: 1em;
      overflow: hidden;
    }

    .digit-inner {
      position: absolute;
      width: 100%;
      text-align: center;
      transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .buy-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.2rem;
      font-size: 1.1rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--main), var(--main-dark));
      color: #000;
      border: none;
      border-radius: var(--radius);
      box-shadow: 0 5px 15px rgba(0, 255, 204, 0.3);
      cursor: pointer;
      margin-top: 1.5rem;
      position: relative;
      transition: var(--transition);
      user-select: none;
      z-index: 1;
      overflow: hidden;
      width: 100%;
      gap: 0.8rem;
    }

    .buy-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.6s;
    }

    .buy-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 255, 204, 0.5);
    }

    .buy-btn:hover::before {
      left: 100%;
    }

    .buy-btn.loading span {
      opacity: 0;
    }

    .buy-btn.loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 24px;
      height: 24px;
      border: 3px solid transparent;
      border-top: 3px solid #000;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    .buy-btn.sold {
      background: linear-gradient(135deg, #555, #333);
      color: #aaa;
      pointer-events: none;
      box-shadow: none;
    }

    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }

    #createBtn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: var(--main);
      color: #000;
      border: none;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      font-size: 2.5rem;
      cursor: pointer;
      animation: bounce 2s infinite;
      box-shadow: var(--shadow);
      z-index: 11;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
      font-weight: 300;
    }

    #createBtn:hover {
      transform: scale(1.1) translateY(-5px);
      animation: none;
      box-shadow: 0 8px 25px rgba(0, 255, 204, 0.6);
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-12px); }
    }

    #uploadModal, #productModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.92);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      display: none;
      backdrop-filter: blur(8px);
      overflow-y: auto;
      padding: 2rem 0;
    }

    #uploadForm, #productDetails {
      background: var(--bg);
      padding: 2.5rem;
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      width: 90%;
      max-width: 800px;
      animation: modalIn 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
      position: relative;
    }

    @keyframes modalIn {
      from {
        opacity: 0;
        transform: translateY(40px) scale(0.95);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .form-title, .product-modal-title {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 1rem;
      color: var(--main);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.8rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .form-group label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-secondary);
    }

    .form-group label i {
      width: 24px;
      color: var(--main);
    }

    #uploadForm input, #uploadForm button, #uploadForm textarea, #uploadForm select {
      padding: 1rem;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 1rem;
      background: var(--bg-light);
      color: var(--text);
      transition: var(--transition);
    }

    #uploadForm input:focus, #uploadForm textarea:focus, #uploadForm select:focus {
      outline: 2px solid var(--main);
      background: #2a2a2a;
    }

    #uploadForm button, #productDetails button {
      background: var(--main);
      color: #000;
      cursor: pointer;
      font-weight: 700;
      margin-top: 1rem;
      padding: 1.2rem;
      font-size: 1.1rem;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 15px rgba(0, 255, 204, 0.3);
    }

    #uploadForm button:hover, #productDetails button:hover {
      background: var(--main-dark);
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0, 255, 204, 0.4);
    }

    .input-row {
      display: flex;
      gap: 1rem;
    }

    .input-row .form-group {
      flex: 1;
    }

    .file-upload {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      border: 2px dashed rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
      background: rgba(0, 0, 0, 0.2);
    }

    .file-upload:hover {
      border-color: var(--main);
      background: rgba(0, 255, 204, 0.05);
    }

    .file-upload i {
      font-size: 3rem;
      color: var(--main);
      margin-bottom: 1rem;
    }

    .preview-container {
      display: none;
      width: 100%;
      margin-top: 0.5rem;
    }

    .preview-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.8rem;
      margin-top: 1rem;
    }

    .preview-item {
      position: relative;
      border-radius: var(--radius-sm);
      overflow: hidden;
      aspect-ratio: 1/1;
    }

    .preview-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .preview-item .remove {
      position: absolute;
      top: 5px;
      right: 5px;
      background: var(--danger);
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 0.8rem;
    }

    .close-modal {
      position: absolute;
      top: 20px;
      right: 20px;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      font-size: 2rem;
      cursor: pointer;
      transition: color 0.2s ease;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }

    .close-modal:hover {
      color: var(--main);
      background: rgba(255, 255, 255, 0.05);
    }

    /* Confetti Animation */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1000;
      display: none;
    }

    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background: var(--main);
      animation: confetti-fall 5s linear forwards;
    }

    @keyframes confetti-fall {
      0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Product Details Modal */
    .product-detail-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 1.5rem;
    }

    .product-detail-images {
      display: flex;
      flex-direction: column;
    }

    .product-main-image {
      width: 100%;
      border-radius: var(--radius-sm);
      aspect-ratio: 16/9;
      object-fit: cover;
      background: #151515;
      margin-bottom: 1rem;
    }

    .product-thumbnails {
      display: flex;
      gap: 0.8rem;
      flex-wrap: wrap;
    }

    .product-thumbnail {
      width: 80px;
      height: 60px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
      opacity: 0.7;
      transition: var(--transition);
      border: 2px solid transparent;
    }

    .product-thumbnail:hover, .product-thumbnail.active {
      opacity: 1;
      border-color: var(--main);
    }

    .product-detail-info {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
    }

    .product-detail-row {
      display: flex;
      justify-content: space-between;
      padding: 0.8rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .product-detail-label {
      color: var(--text-secondary);
      font-weight: 500;
    }

    .product-detail-value {
      font-weight: 600;
      text-align: right;
    }

    .product-description {
      margin-top: 1rem;
      line-height: 1.7;
    }

    .category-badge {
      display: inline-block;
      padding: 0.4rem 1rem;
      border-radius: 50px;
      font-weight: 600;
      font-size: 0.9rem;
    }

    .category-electronics {
      background: rgba(255, 107, 107, 0.2);
      color: var(--category-electronics);
    }

    .category-clothing {
      background: rgba(77, 171, 247, 0.2);
      color: var(--category-clothing);
    }

    .category-bike {
      background: rgba(64, 192, 87, 0.2);
      color: var(--category-bike);
    }

    .category-other {
      background: rgba(204, 93, 232, 0.2);
      color: var(--category-other);
    }

    .condition-badge {
      display: inline-block;
      padding: 0.4rem 1rem;
      border-radius: 50px;
      font-weight: 600;
      font-size: 0.9rem;
      background: rgba(0, 255, 204, 0.2);
      color: var(--main);
    }

    @media (max-width: 768px) {
      .products {
        grid-template-columns: 1fr;
        gap: 1.5rem;
        padding: 0.8rem;
      }
      
      .input-row {
        flex-direction: column;
        gap: 0.8rem;
      }
      
      #uploadForm, #productDetails {
        padding: 1.8rem;
      }
      
      .preview-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .product-detail-content {
        grid-template-columns: 1fr;
      }
      
      .categories {
        justify-content: flex-start;
        overflow-x: auto;
        padding: 1rem 0.5rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo"><i class="fas fa-gem"></i></div>
    <div>OneDrop – Schnapp es dir, bevor es jemand anders tut</div>
  </header>

  <div class="categories" id="categoriesContainer">
    <button class="category-btn active" data-category="all">
      <i class="fas fa-th"></i> Alle
    </button>
    <button class="category-btn" data-category="electronics">
      <i class="fas fa-laptop"></i> Elektronik
    </button>
    <button class="category-btn" data-category="clothing">
      <i class="fas fa-tshirt"></i> Kleidung
    </button>
    <button class="category-btn" data-category="bike">
      <i class="fas fa-bicycle"></i> Fahrrad
    </button>
    <button class="category-btn" data-category="other">
      <i class="fas fa-box"></i> Sonstiges
    </button>
  </div>

  <div class="products" id="productContainer"></div>

  <div id="uploadModal">
    <button class="close-modal" aria-label="Modal schließen">&times;</button>
    <form id="uploadForm">
      <h2 class="form-title"><i class="fas fa-cloud-upload-alt"></i> Neues Produkt</h2>
      
      <div class="form-group">
        <label for="titleInput"><i class="fas fa-tag"></i> Produktname</label>
        <input type="text" id="titleInput" placeholder="Premium Smartwatch" required />
      </div>
      
      <div class="form-group">
        <label for="descriptionInput"><i class="fas fa-align-left"></i> Beschreibung</label>
        <textarea id="descriptionInput" placeholder="Ausführliche Produktbeschreibung..." rows="3"></textarea>
      </div>
      
      <div class="input-row">
        <div class="form-group">
          <label for="startInput"><i class="fas fa-arrow-up"></i> Startpreis (€)</label>
          <input type="number" id="startInput" placeholder="199.99" step="0.01" min="0" required />
        </div>
        
        <div class="form-group">
          <label for="minInput"><i class="fas fa-arrow-down"></i> Minimalpreis (€)</label>
          <input type="number" id="minInput" placeholder="99.99" step="0.01" min="0" required />
        </div>
      </div>
      
      <div class="input-row">
        <div class="form-group">
          <label for="dropInput"><i class="fas fa-hourglass-half"></i> Preisabfall/Min (€)</label>
          <input type="number" id="dropInput" placeholder="10.00" step="0.01" min="0" required />
        </div>
        
        <div class="form-group">
          <label for="timerInput"><i class="fas fa-clock"></i> Timer (Min)</label>
          <input type="number" id="timerInput" placeholder="1" min="1" max="60" value="1" required />
        </div>
      </div>
      
      <div class="input-row">
        <div class="form-group">
          <label for="categoryInput"><i class="fas fa-folder"></i> Kategorie</label>
          <select id="categoryInput" required>
            <option value="">Bitte wählen</option>
            <option value="electronics">Elektronik</option>
            <option value="clothing">Kleidung</option>
            <option value="bike">Fahrrad</option>
            <option value="other">Sonstiges</option>
          </select>
        </div>
        
        <div class="form-group" id="conditionGroup">
          <label for="conditionInput"><i class="fas fa-star"></i> Zustand</label>
          <select id="conditionInput" required>
            <option value="">Bitte Kategorie wählen</option>
          </select>
        </div>
      </div>
      
      <div class="form-group" id="sizeGroup" style="display: none;">
        <label for="sizeInput"><i class="fas fa-ruler"></i> Größe</label>
        <input type="text" id="sizeInput" placeholder="Größe (z.B. M, 42, 10.5)" />
      </div>
      
      <div class="form-group" id="modelGroup" style="display: none;">
        <label for="modelInput"><i class="fas fa-microchip"></i> Modell</label>
        <input type="text" id="modelInput" placeholder="Modellbezeichnung" />
      </div>
      
      <div class="form-group">
        <label><i class="fas fa-images"></i> Produktbilder</label>
        <div class="file-upload" id="fileUploadArea">
          <i class="fas fa-cloud-upload-alt"></i>
          <p>Klicken zum Hochladen oder Dateien hierher ziehen</p>
          <p class="small">(Mehrere Dateien möglich)</p>
          <input type="file" id="imageInput" accept="image/*" multiple style="display:none;" />
        </div>
      </div>
      
      <div class="preview-container" id="previewContainer">
        <p>Ausgewählte Bilder:</p>
        <div class="preview-grid" id="previewGrid"></div>
      </div>
      
      <button type="submit"><i class="fas fa-plus-circle"></i> Produkt hinzufügen</button>
    </form>
  </div>

  <div id="productModal">
    <button class="close-modal" aria-label="Modal schließen">&times;</button>
    <div id="productDetails">
      <!-- Content will be filled by JavaScript -->
    </div>
  </div>

  <button id="createBtn" aria-label="Neues Produkt erstellen">+</button>

  <div class="confetti-container" id="confettiContainer"></div>

  <script>
    // Animation für Zahlenänderungen
    function animateNumberChange(element, newValue, prefix = '') {
      const oldValue = element.dataset.value || '0';
      element.dataset.value = newValue.toString();
      
      const oldStr = oldValue.padStart(4, '0');
      const newStr = newValue.toString().padStart(4, '0');
      
      let html = '';
      
      for (let i = 0; i < newStr.length; i++) {
        const oldChar = oldStr[i];
        const newChar = newStr[i];
        const isDigit = /\d/.test(newChar);
        
        if (oldChar === newChar) {
          html += `<div class="digit">${newChar}</div>`;
        } else {
          html += `
            <div class="digit">
              <div class="digit-inner" style="transform: translateY(${oldChar === ' ' ? '0' : '-100%'});">
                <div>${oldChar}</div>
                <div>${newChar}</div>
              </div>
            </div>
          `;
        }
      }
      
      element.innerHTML = prefix + html;
      
      // Trigger animation
      setTimeout(() => {
        const digitInners = element.querySelectorAll('.digit-inner');
        digitInners.forEach(el => {
          if (el.style.transform !== 'translateY(0%)') {
            el.style.transform = 'translateY(0%)';
          }
        });
      }, 10);
    }

    // Confetti Animation
    function createConfetti() {
      const container = document.getElementById('confettiContainer');
      container.style.display = 'block';
      container.innerHTML = '';
      
      const colors = ['#00ffcc', '#00ccff', '#ff6b6b', '#ffcc00', '#cc00ff'];
      
      for (let i = 0; i < 150; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = `${Math.random() * 100}vw`;
        confetti.style.width = `${Math.random() * 10 + 5}px`;
        confetti.style.height = `${Math.random() * 10 + 5}px`;
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDelay = `${Math.random() * 2}s`;
        confetti.style.opacity = Math.random();
        
        container.appendChild(confetti);
      }
      
      setTimeout(() => {
        container.style.display = 'none';
      }, 5000);
    }

    // Kategorie- und Zustandsdaten
    const categories = {
      electronics: {
        name: "Elektronik",
        conditions: ["Neu", "Gebraucht", "Refurbished", "Defekt"],
        color: "var(--category-electronics)"
      },
      clothing: {
        name: "Kleidung",
        conditions: ["Neu mit Etikett", "Neu ohne Etikett", "Sehr gut", "Gut", "Akzeptabel"],
        color: "var(--category-clothing)"
      },
      bike: {
        name: "Fahrrad",
        conditions: ["Neu", "Gebraucht", "Restauriert", "Vintage"],
        color: "var(--category-bike)"
      },
      other: {
        name: "Sonstiges",
        conditions: ["Neu", "Gebraucht", "Antik", "Sammlerstück"],
        color: "var(--category-other)"
      }
    };

    // Produktmanagement
    const container = document.getElementById('productContainer');
    const categoriesContainer = document.getElementById('categoriesContainer');
    const createBtn = document.getElementById('createBtn');
    const uploadModal = document.getElementById('uploadModal');
    const productModal = document.getElementById('productModal');
    const uploadForm = document.getElementById('uploadForm');
    const closeModals = document.querySelectorAll('.close-modal');
    const fileUploadArea = document.getElementById('fileUploadArea');
    const imageInput = document.getElementById('imageInput');
    const previewContainer = document.getElementById('previewContainer');
    const previewGrid = document.getElementById('previewGrid');
    const categoryInput = document.getElementById('categoryInput');
    const conditionInput = document.getElementById('conditionInput');
    const sizeGroup = document.getElementById('sizeGroup');
    const modelGroup = document.getElementById('modelGroup');
    let uploadedImages = [];
    let products = [];
    let currentCategory = 'all';

    // Kategorie-Filter
    categoriesContainer.addEventListener('click', (e) => {
      if (e.target.classList.contains('category-btn')) {
        document.querySelectorAll('.category-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        e.target.classList.add('active');
        currentCategory = e.target.dataset.category;
        filterProducts();
      }
    });

    function filterProducts() {
      container.innerHTML = '';
      
      const filtered = currentCategory === 'all' 
        ? products 
        : products.filter(p => p.category === currentCategory);
      
      filtered.forEach(product => {
        createProductCard(product);
      });
    }

    // Kategorie-Änderung
    categoryInput.addEventListener('change', () => {
      const category = categoryInput.value;
      conditionInput.innerHTML = '<option value="">Bitte wählen</option>';
      
      if (category && categories[category]) {
        categories[category].conditions.forEach(condition => {
          const option = document.createElement('option');
          option.value = condition;
          option.textContent = condition;
          conditionInput.appendChild(option);
        });
        
        // Kategorie-spezifische Felder anzeigen
        if (category === 'clothing') {
          sizeGroup.style.display = 'flex';
          modelGroup.style.display = 'none';
        } else if (category === 'electronics') {
          sizeGroup.style.display = 'none';
          modelGroup.style.display = 'flex';
        } else {
          sizeGroup.style.display = 'none';
          modelGroup.style.display = 'none';
        }
      } else {
        conditionInput.innerHTML = '<option value="">Bitte Kategorie wählen</option>';
        sizeGroup.style.display = 'none';
        modelGroup.style.display = 'none';
      }
    });

    // Modal Handling
    createBtn.addEventListener('click', () => {
      uploadModal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    });

    closeModals.forEach(btn => {
      btn.addEventListener('click', () => {
        uploadModal.style.display = 'none';
        productModal.style.display = 'none';
        document.body.style.overflow = '';
        resetForm();
      });
    });

    uploadModal.addEventListener('click', (e) => {
      if (e.target === uploadModal) {
        uploadModal.style.display = 'none';
        document.body.style.overflow = '';
        resetForm();
      }
    });

    productModal.addEventListener('click', (e) => {
      if (e.target === productModal) {
        productModal.style.display = 'none';
        document.body.style.overflow = '';
      }
    });

    // File Upload Handling
    fileUploadArea.addEventListener('click', () => {
      imageInput.click();
    });

    fileUploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      fileUploadArea.style.borderColor = 'var(--main)';
      fileUploadArea.style.backgroundColor = 'rgba(0, 255, 204, 0.1)';
    });

    fileUploadArea.addEventListener('dragleave', () => {
      fileUploadArea.style.borderColor = 'rgba(255, 255, 255, 0.1)';
      fileUploadArea.style.backgroundColor = 'rgba(0, 0, 0, 0.2)';
    });

    fileUploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      fileUploadArea.style.borderColor = 'rgba(255, 255, 255, 0.1)';
      fileUploadArea.style.backgroundColor = 'rgba(0, 0, 0, 0.2)';
      
      if (e.dataTransfer.files.length > 0) {
        imageInput.files = e.dataTransfer.files;
        handleFileUpload(e.dataTransfer.files);
      }
    });

    imageInput.addEventListener('change', function() {
      if (this.files.length > 0) {
        handleFileUpload(this.files);
      }
    });

    function handleFileUpload(files) {
      for (let i = 0; i < files.length; i++) {
        const file = files[i];
        if (!file.type.match('image.*')) continue;
        
        const reader = new FileReader();
        
        reader.onload = function(e) {
          uploadedImages.push(e.target.result);
          updatePreview();
        };
        
        reader.readAsDataURL(file);
      }
    }

    function updatePreview() {
      previewGrid.innerHTML = '';
      
      if (uploadedImages.length > 0) {
        previewContainer.style.display = 'block';
        
        uploadedImages.forEach((img, index) => {
          const previewItem = document.createElement('div');
          previewItem.className = 'preview-item';
          previewItem.innerHTML = `
            <img src="${img}" alt="Preview ${index + 1}">
            <button class="remove" data-index="${index}">&times;</button>
          `;
          previewGrid.appendChild(previewItem);
        });
        
        // Add remove event listeners
        document.querySelectorAll('.preview-item .remove').forEach(btn => {
          btn.addEventListener('click', (e) => {
            const index = parseInt(e.target.dataset.index);
            uploadedImages.splice(index, 1);
            updatePreview();
            e.stopPropagation();
          });
        });
      } else {
        previewContainer.style.display = 'none';
      }
    }

    function resetForm() {
      uploadForm.reset();
      uploadedImages = [];
      updatePreview();
      sizeGroup.style.display = 'none';
      modelGroup.style.display = 'none';
      conditionInput.innerHTML = '<option value="">Bitte Kategorie wählen</option>';
    }

    // Formular Handling
    uploadForm.addEventListener('submit', (e) => {
      e.preventDefault();

      const title = document.getElementById('titleInput').value.trim();
      const description = document.getElementById('descriptionInput').value.trim();
      const start = parseFloat(document.getElementById('startInput').value);
      const min = parseFloat(document.getElementById('minInput').value);
      const drop = parseFloat(document.getElementById('dropInput').value);
      const timer = parseInt(document.getElementById('timerInput').value, 10);
      const category = document.getElementById('categoryInput').value;
      const condition = document.getElementById('conditionInput').value;
      const size = document.getElementById('sizeInput')?.value || '';
      const model = document.getElementById('modelInput')?.value || '';

      // Validierung
      if (!title || isNaN(start) || isNaN(min) || isNaN(drop) || isNaN(timer) || !category || !condition) {
        alert('Bitte alle Felder korrekt ausfüllen!');
        return;
      }

      if (start < min) {
        alert('Startpreis muss höher als Minimalpreis sein!');
        return;
      }

      if (timer <= 0) {
        alert('Timer muss größer als 0 sein!');
        return;
      }

      // Produkt erstellen
      const productData = {
        title,
        description,
        start,
        min,
        drop,
        timer,
        category,
        condition,
        size,
        model,
        images: [...uploadedImages],
        id: Date.now().toString(),
        createdAt: new Date().toISOString()
      };
      
      addProduct(productData);
      
      // Erfolgsanimation
      createConfetti();
      
      // Modal schließen und zurücksetzen
      setTimeout(() => {
        uploadModal.style.display = 'none';
        document.body.style.overflow = '';
        resetForm();
      }, 1000);
    });

    // Produkt erstellen
    function addProduct(productData) {
      products.push(productData);
      createProductCard(productData);
    }

    function createProductCard(productData) {
      const product = document.createElement('div');
      product.className = 'product-card';
      product.dataset.id = productData.id;
      product.dataset.category = productData.category;

      let currentPrice = productData.start;
      const startTime = Date.now();
      let currentImageIndex = 0;

      // Bilder-Container
      const imagesContainer = document.createElement('div');
      imagesContainer.className = 'product-images';
      
      const mainImage = document.createElement('img');
      mainImage.className = 'main-image';
      mainImage.alt = productData.title;
      
      // Wenn Bilder vorhanden, erstes anzeigen
      if (productData.images.length > 0) {
        mainImage.src = productData.images[0];
      } else {
        // Platzhalter, wenn keine Bilder
        mainImage.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="%23333" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><path d="M21 15l-5-5L5 21"></path></svg>';
      }
      
      imagesContainer.appendChild(mainImage);
      
      // Miniaturansichten
      if (productData.images.length > 1) {
        const thumbnails = document.createElement('div');
        thumbnails.className = 'thumbnails';
        
        productData.images.forEach((img, index) => {
          const thumb = document.createElement('img');
          thumb.className = `thumbnail ${index === 0 ? 'active' : ''}`;
          thumb.src = img;
          thumb.alt = `Thumbnail ${index + 1}`;
          thumb.dataset.index = index;
          
          thumb.addEventListener('click', (e) => {
            mainImage.src = img;
            document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
            thumb.classList.add('active');
            currentImageIndex = index;
            e.stopPropagation();
          });
          
          thumbnails.appendChild(thumb);
        });
        
        imagesContainer.appendChild(thumbnails);
      }
      
      product.appendChild(imagesContainer);
      
      // Titel
      const titleEl = document.createElement('div');
      titleEl.className = 'product-title';
      titleEl.innerHTML = `<i class="fas fa-cube"></i>${productData.title}`;
      product.appendChild(titleEl);
      
      // Kategorie-Badge
      const categoryEl = document.createElement('div');
      categoryEl.className = `category-badge category-${productData.category}`;
      categoryEl.textContent = categories[productData.category]?.name || 'Sonstiges';
      titleEl.appendChild(categoryEl);
      
      // Preis
      const priceContainer = document.createElement('div');
      priceContainer.className = 'price-container';
      priceContainer.innerHTML = `
        <i class="fas fa-tag"></i>
        <div class="price">
          <span class="value" id="priceValue">€${productData.start.toFixed(2)}</span>
        </div>
      `;
      product.appendChild(priceContainer);
      const priceValue = priceContainer.querySelector('.value');
      
      // Timer
      const timerContainer = document.createElement('div');
      timerContainer.className = 'timer-container';
      timerContainer.innerHTML = `
        <i class="fas fa-clock"></i>
        <div class="timer">
          <span class="value" id="timerValue">${productData.timer}:00</span>
        </div>
      `;
      product.appendChild(timerContainer);
      const timerValue = timerContainer.querySelector('.value');
      
      // Zustand
      const conditionEl = document.createElement('div');
      conditionEl.className = 'condition-badge';
      conditionEl.textContent = productData.condition;
      timerContainer.appendChild(conditionEl);
      
      // Kaufen-Button
      const btn = document.createElement('button');
      btn.className = 'buy-btn';
      btn.innerHTML = '<i class="fas fa-shopping-cart"></i><span>Jetzt kaufen</span>';
      
      btn.addEventListener('click', (e) => {
        if (btn.classList.contains('sold')) return;
        
        btn.classList.add('loading');
        
        setTimeout(() => {
          btn.classList.remove('loading');
          btn.classList.add('sold');
          btn.innerHTML = '<i class="fas fa-check"></i><span>Verkauft!</span>';
          alert(`Danke für deinen Kauf von "${productData.title}" für €${currentPrice.toFixed(2)}!`);
          e.stopPropagation();
        }, 2000);
      });
      
      product.appendChild(btn);
      
      // Produktkarte anklickbar machen
      product.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON' || e.target.closest('button')) return;
        showProductDetails(productData);
      });
      
      // Produkt hinzufügen
      container.appendChild(product);
      
      // Timer-Logik
      function updateProduct() {
        if (btn.classList.contains('sold')) return;
        
        const elapsed = (Date.now() - startTime) / 1000;
        const dropsOccurred = Math.floor(elapsed / (productData.timer * 60));
        const newPrice = Math.max(productData.min, productData.start - productData.drop * dropsOccurred);
        
        // Preis aktualisieren
        if (Math.abs(newPrice - currentPrice) >= 0.01) {
          currentPrice = newPrice;
          animateNumberChange(priceValue, newPrice.toFixed(2), '€');
        }
        
        // Timer aktualisieren
        const timeToNextDrop = (productData.timer * 60) - (elapsed % (productData.timer * 60));
        const minutes = Math.floor(timeToNextDrop / 60);
        const seconds = Math.floor(timeToNextDrop % 60);
        
        timerValue.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        
        requestAnimationFrame(updateProduct);
      }
      
      // Timer starten
      updateProduct();
    }

    // Produktdetails anzeigen
    function showProductDetails(productData) {
      const modalBody = document.getElementById('productDetails');
      
      modalBody.innerHTML = `
        <h2 class="product-modal-title">
          <i class="fas fa-info-circle"></i> ${productData.title}
          <span class="category-badge category-${productData.category}">
            ${categories[productData.category]?.name || 'Sonstiges'}
          </span>
        </h2>
        
        <div class="product-detail-content">
          <div class="product-detail-images">
            <img src="${productData.images.length > 0 ? productData.images[0] : 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="%23333" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><path d="M21 15l-5-5L5 21"></path></svg>'}" 
                 alt="${productData.title}" class="product-main-image" id="detailMainImage">
            
            ${productData.images.length > 1 ? `
              <div class="product-thumbnails">
                ${productData.images.map((img, index) => `
                  <img src="${img}" 
                       class="product-thumbnail ${index === 0 ? 'active' : ''}" 
                       alt="Thumbnail ${index + 1}"
                       data-index="${index}">
                `).join('')}
              </div>
            ` : ''}
          </div>
          
          <div class="product-detail-info">
            <div class="product-detail-row">
              <div class="product-detail-label">Aktueller Preis:</div>
              <div class="product-detail-value" id="detailPrice">€${productData.start.toFixed(2)}</div>
            </div>
            
            <div class="product-detail-row">
              <div class="product-detail-label">Nächster Preisabfall in:</div>
              <div class="product-detail-value" id="detailTimer">${productData.timer}:00</div>
            </div>
            
            <div class="product-detail-row">
              <div class="product-detail-label">Zustand:</div>
              <div class="product-detail-value">
                <span class="condition-badge">${productData.condition}</span>
              </div>
            </div>
            
            ${productData.size ? `
              <div class="product-detail-row">
                <div class="product-detail-label">Größe:</div>
                <div class="product-detail-value">${productData.size}</div>
              </div>
            ` : ''}
            
            ${productData.model ? `
              <div class="product-detail-row">
                <div class="product-detail-label">Modell:</div>
                <div class="product-detail-value">${productData.model}</div>
              </div>
            ` : ''}
            
            <div class="product-detail-row">
              <div class="product-detail-label">Preisabfall:</div>
              <div class="product-detail-value">€${productData.drop.toFixed(2)} pro Minute</div>
            </div>
            
            <div class="product-detail-row">
              <div class="product-detail-label">Minimalpreis:</div>
              <div class="product-detail-value">€${productData.min.toFixed(2)}</div>
            </div>
            
            ${productData.description ? `
              <div class="product-description">
                <h3><i class="fas fa-align-left"></i> Beschreibung</h3>
                <p>${productData.description}</p>
              </div>
            ` : ''}
            
            <button class="buy-btn">
              <i class="fas fa-shopping-cart"></i>
              <span>Jetzt kaufen</span>
            </button>
          </div>
        </div>
      `;
      
      // Thumbnail-Klick
      if (productData.images.length > 1) {
        document.querySelectorAll('.product-thumbnail').forEach(thumb => {
          thumb.addEventListener('click', () => {
            const index = thumb.dataset.index;
            document.getElementById('detailMainImage').src = productData.images[index];
            document.querySelectorAll('.product-thumbnail').forEach(t => t.classList.remove('active'));
            thumb.classList.add('active');
          });
        });
      }
      
      // Kaufen-Button
      document.querySelector('#productDetails .buy-btn').addEventListener('click', () => {
        alert(`Danke für deinen Kauf von "${productData.title}"!`);
      });
      
      productModal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    // Beispielprodukte
    document.addEventListener('DOMContentLoaded', () => {
      // Initiale Produkte
      const sampleProducts = [
        {
          id: "1",
          title: "Premium Kopfhörer",
          description: "Kabellose Noise-Cancelling Kopfhörer mit 30h Akkulaufzeit",
          start: 199.99,
          min: 99.99,
          drop: 10,
          timer: 2,
          category: "electronics",
          condition: "Neu",
          model: "SoundMax Pro X3",
          images: [],
          createdAt: "2023-10-15"
        },
        {
          id: "2",
          title: "Smart Watch Pro",
          description: "Smartwatch mit Fitness-Tracking und Herzfrequenzmessung",
          start: 249.99,
          min: 149.99,
          drop: 15,
          timer: 3,
          category: "electronics",
          condition: "Refurbished",
          model: "TechWatch 2023",
          images: [],
          createdAt: "2023-10-10"
        },
        {
          id: "3",
          title: "Designer Jeans",
          description: "Premium Denim-Jeans im Slim Fit, waschbar bei 40°C",
          start: 89.99,
          min: 39.99,
          drop: 5,
          timer: 1,
          category: "clothing",
          condition: "Neu mit Etikett",
          size: "32/32",
          images: [],
          createdAt: "2023-10-12"
        },
        {
          id: "4",
          title: "Mountainbike",
          description: "Professionelles Mountainbike mit Federgabel und Scheibenbremsen",
          start: 799.99,
          min: 399.99,
          drop: 20,
          timer: 5,
          category: "bike",
          condition: "Gebraucht",
          images: [],
          createdAt: "2023-10-05"
        }
      ];
      
      sampleProducts.forEach(product => {
        addProduct(product);
      });
    });
  </script>
</body>
</html>